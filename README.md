# CVE-2020-11851
Remote Code Execution vulnerability on ArcSight Logger(via ArcSight ESM)

### Executive Summary
### Vulnerability Background
There are about 685 companies that use HP ArcSight ESM. The companies using HP ArcSight ESM are most often found in United States and in the Computer Software industry. HP ArcSight ESM is most often used by companies with >10000 employees and >1000M dollars in revenue. 
The vulnerability is present in backup functionality of ArcSight Management Center(version: 2.7.1.2065.0) and requires authentication. This backup option works by using “expect” scripts of ArcSight Logger which use Tool Command Language (Tcl). The vulnerability allows attackers to execute arbitrary Tcl commands which can be executed in the related Tcl script. 

### Conclusion
The server running the vulnerable software can be comprimised by attackers via the RCE vulnerability and become a beachhead from which an adversary could launch further attacks against the organization’s servers, culminating in a serious breach. This vulnerability can result in data loss, corruption, or disclosure to unauthorized parties, loss of accountability or denial of access. 

### Recommendations
It is recommended to check Tcl security best practices for “expect” scripts. Basically, using braces in eval would be safe like below:
`eval puts $exploit   ;# vulnerable`  
`eval "puts $exploit" ;# vulnerable`  
`eval {puts $exploit} ;# safe` 
More information can be found here: https://wiki.tcl-lang.org/page/Injection+Attack

### Technical Background

##### Exploring the vulnerable backup option

##### Debugging the server & Root cause analysis

##### Gaining the code execution
